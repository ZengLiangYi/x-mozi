<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Human Video Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Digital Human Video Generator</h1>
            <p>Upload a face image/video and provide audio to generate lip-synced videos</p>
        </header>

        <main>
            <div class="card">
                <h2>Step 1: Upload Face</h2>
                <div class="upload-section">
                    <div class="upload-area" id="faceUploadArea">
                        <input type="file" id="faceInput" accept="image/*,video/*" hidden>
                        <div class="upload-content">
                            <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="17 8 12 3 7 8"/>
                                <line x1="12" y1="3" x2="12" y2="15"/>
                            </svg>
                            <p>Click or drag to upload face image/video</p>
                            <span class="hint">Supports: JPG, PNG, MP4, AVI, MOV</span>
                        </div>
                    </div>
                    <div class="preview" id="facePreview"></div>
                    <div class="file-info" id="faceInfo"></div>
                </div>
            </div>

            <div class="card">
                <h2>Step 2: Provide Audio</h2>
                <div class="tabs">
                    <button class="tab active" data-tab="upload">Upload Audio</button>
                    <button class="tab" data-tab="tts">Text to Speech</button>
                </div>

                <div class="tab-content active" id="uploadTab">
                    <div class="upload-area" id="audioUploadArea">
                        <input type="file" id="audioInput" accept="audio/*" hidden>
                        <div class="upload-content">
                            <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 18V5l12-2v13"/>
                                <circle cx="6" cy="18" r="3"/>
                                <circle cx="18" cy="16" r="3"/>
                            </svg>
                            <p>Click or drag to upload audio file</p>
                            <span class="hint">Supports: WAV, MP3, M4A, AAC, OGG</span>
                        </div>
                    </div>
                    <audio id="audioPreview" controls style="display:none; width:100%; margin-top:10px;"></audio>
                    <div class="file-info" id="audioInfo"></div>
                </div>

                <div class="tab-content" id="ttsTab">
                    <div class="tts-section">
                        <div class="form-group">
                            <label for="voiceSelect">Select Voice</label>
                            <select id="voiceSelect">
                                <option value="zh-CN-XiaoxiaoNeural" data-locale="zh-CN">Xiaoxiao (Chinese Female)</option>
                                <option value="zh-CN-YunxiNeural" data-locale="zh-CN">Yunxi (Chinese Male)</option>
                                <option value="en-US-JennyNeural" data-locale="en-US">Jenny (English Female)</option>
                                <option value="en-US-GuyNeural" data-locale="en-US">Guy (English Male)</option>
                                <option value="Matthew" data-locale="en-US">Matthew (Murf)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ttsText">Enter Text</label>
                            <textarea id="ttsText" rows="4" placeholder="Enter the text you want to convert to speech..."></textarea>
                        </div>
                        <button class="btn btn-secondary" id="generateTTSBtn">
                            <span class="btn-text">Generate Audio</span>
                            <span class="btn-loading" style="display:none;">Generating...</span>
                        </button>
                        <audio id="ttsAudioPreview" controls style="display:none; width:100%; margin-top:10px;"></audio>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Step 3: Generate Video</h2>
                <div class="generate-section">
                    <div class="status-bar" id="statusBar">
                        <div class="status-icon"></div>
                        <span class="status-text">Ready to generate</span>
                    </div>

                    <!-- 实时预览模式切换 -->
                    <div class="mode-toggle">
                        <label class="toggle-label">
                            <input type="checkbox" id="realtimeMode" checked>
                            <span class="toggle-text">Real-time Preview Mode (shows frames as they generate)</span>
                        </label>
                    </div>

                    <!-- 画质/速度设置 -->
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="qualitySelect">Quality / Speed</label>
                        <select id="qualitySelect">
                            <option value="1.0">High Quality (Original Resolution)</option>
                            <option value="0.75">Medium Quality (75% - Faster)</option>
                            <option value="0.5" selected>Low Quality (50% - Much Faster)</option>
                            <option value="0.25">Draft (25% - Fastest)</option>
                        </select>
                    </div>

                    <button class="btn btn-primary" id="generateBtn" disabled>
                        <span class="btn-text">Generate Digital Human Video</span>
                        <span class="btn-loading" style="display:none;">Processing...</span>
                    </button>
                    <div class="progress-container" id="progressContainer" style="display:none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <span class="progress-text" id="progressText">0%</span>
                    </div>
                </div>
            </div>

            <!-- 实时预览区域 -->
            <div class="card" id="realtimePreviewCard" style="display:none;">
                <h2>Real-time Preview</h2>
                <div class="realtime-preview-section">
                    <div class="preview-stats">
                        <span id="frameCounter">Frame: 0/0</span>
                        <span id="fpsCounter">FPS: --</span>
                        <span id="etaCounter">ETA: --</span>
                    </div>
                    <div class="canvas-container">
                        <canvas id="realtimeCanvas"></canvas>
                    </div>
                    <div class="preview-status" id="previewStatus">Waiting to start...</div>
                </div>
            </div>

            <div class="card" id="resultCard" style="display:none;">
                <h2>Generated Video</h2>
                <div class="result-section">
                    <video id="resultVideo" controls></video>
                    <div class="result-actions">
                        <button class="btn btn-secondary" id="downloadBtn">Download Video</button>
                        <button class="btn btn-outline" id="newGenerateBtn">Generate New</button>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Powered by Wav2Lip | Digital Human Video Generation System</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
