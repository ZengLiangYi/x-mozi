# X-Mozi æ™ºèƒ½ä½“è¯­éŸ³äº¤äº’åº”ç”¨ - æŠ€æœ¯æ–¹æ¡ˆè§„åˆ’

> åˆ›å»ºæ—¶é—´ï¼š2025-12-06
> é¡¹ç›®ç›®æ ‡ï¼šåŸºäº Next.js + Ant Design X æ„å»ºæ™ºèƒ½ä½“è¯­éŸ³äº¤äº’åº”ç”¨

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 æ ¸å¿ƒåŠŸèƒ½

1. **æ™ºèƒ½ä½“è§†é¢‘å±•ç¤º**
   - ä»¥è§†é¢‘å½¢å¼å±•ç¤ºæ™ºèƒ½ä½“å½¢è±¡
   - è§†é¢‘è‡ªåŠ¨å¾ªç¯æ’­æ”¾
   - ç¦æ­¢ç”¨æˆ·æ§åˆ¶ï¼ˆæš‚åœã€å¿«è¿›ç­‰ï¼‰
   - æ”¯æŒåˆ‡æ¢ä¸åŒè§†é¢‘/å½¢è±¡

2. **è¯­éŸ³äº¤äº’**
   - ç”¨æˆ·é€šè¿‡è¯­éŸ³è¾“å…¥ï¼ˆç‚¹å‡»è¯´è¯ï¼‰
   - æ™ºèƒ½ä½“é€šè¿‡è¯­éŸ³å›å¤
   - æ”¯æŒå®æ—¶è¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³åˆæˆ

3. **æ™ºèƒ½å¯¹è¯**
   - åŸºäº Coze æ™ºèƒ½ä½“å®ç°å¯¹è¯èƒ½åŠ›
   - æ”¯æŒæµå¼å“åº”

### 1.2 äº¤äº’æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»è¯´è¯ â†’ è…¾è®¯äº‘ ASR å®æ—¶è¯†åˆ« â†’ æ–‡å­—å‘é€è‡³ Coze
                                            â†“
æ’­æ”¾è¯­éŸ³å›å¤ â† è…¾è®¯äº‘ TTS åˆæˆ â† Coze è¿”å›å›å¤æ–‡æœ¬
```

---

## äºŒã€æŠ€æœ¯æ¶æ„

### 2.1 æŠ€æœ¯é€‰å‹

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ |
|------|----------|------|
| æ¡†æ¶ | Next.js (App Router) | latest |
| UI æ¡†æ¶ | React | ^19.2 |
| AI ç»„ä»¶åº“ | Ant Design X | ^2.1.0 |
| åŸºç¡€ç»„ä»¶åº“ | Ant Design | ^6.0.1 |
| çŠ¶æ€ç®¡ç† | Zustand | ^5.0.9 |
| è¯­éŸ³è¯†åˆ« | è…¾è®¯äº‘ ASR | - |
| è¯­éŸ³åˆæˆ | è…¾è®¯äº‘ TTS | - |
| æ™ºèƒ½ä½“ | Coze SDK | @coze/api |
| è…¾è®¯äº‘ SDK | tencentcloud-sdk-nodejs | - |
| HTTP å®¢æˆ·ç«¯ | axios | ^1.7.9 |
| éŸ³é¢‘å¯è§†åŒ– | react-audio-visualize | ^1.2.0 |
| å½•éŸ³ç»„ä»¶ | react-media-recorder | ^1.7.1 |

### 2.2 æ¶æ„è¯´æ˜

é€‰æ‹© **Next.js å…¨æ ˆæ–¹æ¡ˆ**ï¼ŒåŸå› ï¼š
- å‰åç«¯åˆä¸€ï¼Œç»´æŠ¤ç®€å•
- API Routes è¿è¡Œåœ¨æœåŠ¡ç«¯ï¼Œå¯†é’¥å®‰å…¨
- éƒ¨ç½²ä¾¿æ·ï¼ˆVercel ç­‰å¹³å°ä¸€é”®éƒ¨ç½²ï¼‰
- æ”¯æŒ React 19

---

## ä¸‰ã€é¡¹ç›®ç»“æ„

```
x-mozi/
â”œâ”€â”€ app/                       # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx             # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx               # é¦–é¡µï¼ˆæ™ºèƒ½ä½“ç•Œé¢ï¼‰
â”‚   â”œâ”€â”€ globals.css            # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ api/                   # åç«¯ API Routes
â”‚       â”œâ”€â”€ tts/route.ts       # è¯­éŸ³åˆæˆæ¥å£
â”‚       â”œâ”€â”€ asr/route.ts       # è¯­éŸ³è¯†åˆ«æ¥å£
â”‚       â””â”€â”€ chat/route.ts      # Coze å¯¹è¯æ¥å£
â”‚
â”œâ”€â”€ components/                # React ç»„ä»¶
â”‚   â”œâ”€â”€ AvatarVideo/           # æ™ºèƒ½ä½“è§†é¢‘ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ style.module.css
â”‚   â”œâ”€â”€ VoiceButton/           # è¯­éŸ³è¾“å…¥æŒ‰é’®
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â””â”€â”€ style.module.css
â”‚   â””â”€â”€ ChatPanel/             # å¯¹è¯é¢æ¿ï¼ˆAnt Design Xï¼‰
â”‚       â”œâ”€â”€ index.tsx
â”‚       â””â”€â”€ style.module.css
â”‚
â”œâ”€â”€ services/                  # å‰ç«¯ API è°ƒç”¨å°è£…
â”‚   â”œâ”€â”€ tts.ts                 # TTS æœåŠ¡
â”‚   â”œâ”€â”€ asr.ts                 # ASR æœåŠ¡
â”‚   â””â”€â”€ chat.ts                # å¯¹è¯æœåŠ¡
â”‚
â”œâ”€â”€ hooks/                     # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ useVoiceRecognition.ts # è¯­éŸ³è¯†åˆ« Hook
â”‚   â””â”€â”€ useTextToSpeech.ts     # è¯­éŸ³åˆæˆ Hook
â”‚
â”œâ”€â”€ store/                     # Zustand çŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ chatStore.ts           # å¯¹è¯çŠ¶æ€
â”‚
â”œâ”€â”€ public/
â”‚   â””â”€â”€ videos/                # æ™ºèƒ½ä½“è§†é¢‘èµ„æº
â”‚       â”œâ”€â”€ avatar-idle.mp4    # å¾…æœºçŠ¶æ€è§†é¢‘
â”‚       â””â”€â”€ avatar-talk.mp4    # è¯´è¯çŠ¶æ€è§†é¢‘ï¼ˆå¯é€‰ï¼‰
â”‚
â”œâ”€â”€ .env.local                 # ç¯å¢ƒå˜é‡ï¼ˆå¯†é’¥ï¼Œä¸æäº¤ Gitï¼‰
â”œâ”€â”€ next.config.js             # Next.js é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

---

## å››ã€æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 4.1 AvatarVideo æ™ºèƒ½ä½“è§†é¢‘ç»„ä»¶

**åŠŸèƒ½è¦æ±‚ï¼š**
- æ”¯æŒ5å¥—å½¢è±¡åˆ‡æ¢ï¼Œæ¯å¥—åŒ…å«ä¸‰ä¸ªçŠ¶æ€è§†é¢‘ï¼ˆIdle, Talk, Danceï¼‰ã€‚
- ä½¿ç”¨åŸç”Ÿ `<video>` æ ‡ç­¾ï¼Œéšè—æ§åˆ¶æ ã€‚
- çŠ¶æ€æœºç®¡ç†è§†é¢‘æ’­æ”¾é€»è¾‘ï¼Œç¡®ä¿çŠ¶æ€åˆ‡æ¢å¹³æ»‘ã€‚
- æä¾›â€œè·³èˆâ€åŠŸèƒ½ï¼Œä¸è¯­éŸ³å›å¤äº’æ–¥ã€‚

**æ•°æ®ç»“æ„ï¼š**
```typescript
type AvatarAction = 'idle' | 'talk' | 'dance';

interface AvatarModel {
  id: string;
  name: string;
  videos: {
    idle: string; // é™æ¯è§†é¢‘ (loop)
    talk: string; // è®²è¯è§†é¢‘ (loop)
    dance: string; // è·³èˆè§†é¢‘ (play once)
  };
}
```

**çŠ¶æ€æµè½¬é€»è¾‘ï¼š**

| å½“å‰çŠ¶æ€ | è§¦å‘äº‹ä»¶ | ç›®æ ‡çŠ¶æ€ | å¤‡æ³¨ |
| :--- | :--- | :--- | :--- |
| **Idle** | TTS Start | **Talk** | å¾ªç¯æ’­æ”¾ |
| **Idle** | ç‚¹å‡»è·³èˆ | **Dance** | æ’­æ”¾ä¸€æ¬¡ååˆ‡å› Idle |
| **Talk** | TTS End | **Idle** | - |
| **Talk** | ç‚¹å‡»è·³èˆ | **(æ— æ•ˆ)** | ç¦ç”¨æŒ‰é’® |
| **Dance** | æ’­æ”¾ç»“æŸ | **Idle** | - |
| **Dance** | TTS Start | **Talk** | ç«‹å³æ‰“æ–­è·³èˆ |

**å…³é”®ä»£ç ç¤ºä¾‹ï¼š**
```tsx
<video
  ref={videoRef}
  src={currentVideo} // æ ¹æ®å½“å‰å½¢è±¡IDå’ŒçŠ¶æ€è®¡ç®—
  autoPlay
  loop={action !== 'dance'} // è·³èˆä¸å¾ªç¯
  muted
  controls={false}
  onEnded={() => {
    if (action === 'dance') setAction('idle');
  }}
  style={{ pointerEvents: 'none' }}
/>
```

### 4.2 VoiceButton è¯­éŸ³è¾“å…¥ç»„ä»¶

**è®¾è®¡ç†å¿µï¼š**
- **ç®€çº¦ä¼˜ç¾**ï¼šç§»é™¤ç”Ÿç¡¬çš„è„‰å†²åŠ¨ç”»ï¼Œè¿½æ±‚è‡ªç„¶çš„è¿‡æ¸¡æ•ˆæœ
- **è½»æ¾äº¤äº’**ï¼šé‡‡ç”¨"ç‚¹å‡»å¼€å§‹/ç‚¹å‡»ç»“æŸ"æ¨¡å¼ï¼Œé‡Šæ”¾ç”¨æˆ·æ‰‹æŒ‡
- **è§†è§‰åé¦ˆ**ï¼šèšç„¦äºå®æ—¶æ³¢å½¢çš„ç»†è…»å¾‹åŠ¨

**åŠŸèƒ½è¦æ±‚ï¼š**
- ç‚¹å‡»éº¦å…‹é£å›¾æ ‡åˆ‡æ¢å½•éŸ³çŠ¶æ€
- å½•éŸ³æ—¶æ˜¾ç¤ºä¼˜é›…çš„å®æ—¶å£°æ³¢
- å†æ¬¡ç‚¹å‡»åœæ­¢å½•éŸ³å¹¶å‘é€

**äº¤äº’æµç¨‹ï¼š**
1. ç”¨æˆ·ç‚¹å‡»æŒ‰é’® â†’ æ¿€æ´»å½•éŸ³çŠ¶æ€ â†’ æŒ‰é’®å½¢æ€å¹³æ»‘è¿‡æ¸¡
2. æ˜¾ç¤ºå®æ—¶éŸ³é¢‘æ³¢å½¢ï¼ˆVisualizerï¼‰
3. ç”¨æˆ·å†æ¬¡ç‚¹å‡» â†’ ç»“æŸå½•éŸ³ â†’ æäº¤éŸ³é¢‘å¤„ç†

#### åŠ¨ç”»å®ç°æ–¹æ¡ˆ

é‡‡ç”¨ **react-audio-visualize** + **Framer Motion** å®ç°ç”µå½±çº§çš„äº¤äº’åŠ¨æ•ˆã€‚

| çŠ¶æ€ | è§†è§‰è¡¨ç° | åŠ¨ç”»æ•ˆæœ |
|------|----------|----------|
| **äº¤äº’åé¦ˆ** | æŒ‰é’®ç‚¹å‡» | å¼¹æ€§ç¼©æ”¾ (`scale`), ç‰©ç†å›å¼¹æ•ˆæœ |
| **çŠ¶æ€åˆ‡æ¢** | å›¾æ ‡å˜æ¢ | æ—‹è½¬æ·¡å…¥æ·¡å‡º (`rotate`, `opacity`) |
| **æ³¢å½¢å±•ç¤º** | åŠ¨æ€å±•å¼€ | é«˜åº¦ä¸é€æ˜åº¦çš„å¹³æ»‘è¿‡æ¸¡ (`AnimatePresence`) |

**æ ¸å¿ƒä¾èµ–ï¼š**
```bash
npm install react-audio-visualize react-media-recorder framer-motion clsx
```

**å…³é”®ä»£ç ç¤ºä¾‹ï¼š**

```tsx
// components/VoiceButton/index.tsx
import { useState } from 'react';
import { LiveAudioVisualizer } from 'react-audio-visualize';
import { useReactMediaRecorder } from 'react-media-recorder';
import { motion, AnimatePresence } from 'framer-motion';
import { AudioOutlined, StopOutlined } from '@ant-design/icons';
import styles from './style.module.css';

export function VoiceButton({ onRecordComplete }: { onRecordComplete: (blob: Blob) => void }) {
  const { status, startRecording, stopRecording, mediaRecorder } = 
    useReactMediaRecorder({ 
      audio: true,
      onStop: (blobUrl, blob) => onRecordComplete(blob)
    });

  const isRecording = status === 'recording';

  const handleToggle = () => {
    if (isRecording) {
      stopRecording();
    } else {
      startRecording();
    }
  };

  return (
    <div className={styles.container}>
      {/* å½•éŸ³æ—¶æ˜¾ç¤ºçš„æ³¢å½¢åŒºåŸŸ - å¹³æ»‘è¿›å‡ºåœº */}
      <AnimatePresence>
        {isRecording && mediaRecorder && (
          <motion.div
            initial={{ opacity: 0, height: 0, y: 10 }}
            animate={{ opacity: 1, height: 40, y: 0 }}
            exit={{ opacity: 0, height: 0, y: 10 }}
            transition={{ type: 'spring', stiffness: 300, damping: 25 }}
            className={styles.visualizerWrapper}
          >
            <LiveAudioVisualizer
              mediaRecorder={mediaRecorder}
              width={120}
              height={30}
              barWidth={2}
              gap={2}
              barColor="#667eea"
            />
          </motion.div>
        )}
      </AnimatePresence>

      {/* ä¸»æŒ‰é’® - å¼¹æ€§äº¤äº’ */}
      <motion.button
        className={`${styles.button} ${isRecording ? styles.active : ''}`}
        onClick={handleToggle}
        whileHover={{ scale: 1.05 }}
        whileTap={{ scale: 0.95 }}
        layout
      >
        <AnimatePresence mode='wait'>
          {isRecording ? (
            <motion.span
              key="stop"
              initial={{ scale: 0, rotate: -90 }}
              animate={{ scale: 1, rotate: 0 }}
              exit={{ scale: 0, rotate: 90 }}
            >
              <StopOutlined />
            </motion.span>
          ) : (
            <motion.span
              key="mic"
              initial={{ scale: 0, rotate: 90 }}
              animate={{ scale: 1, rotate: 0 }}
              exit={{ scale: 0, rotate: -90 }}
            >
              <AudioOutlined />
            </motion.span>
          )}
        </AnimatePresence>
      </motion.button>
    </div>
  );
}
```

**æ ·å¼æ–‡ä»¶ï¼š**

```css
/* components/VoiceButton/style.module.css */
.container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  position: relative;
}

.visualizer {
  height: 30px;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.3s ease-out;
  pointer-events: none;
}

.visualizer.show {
  opacity: 1;
  transform: translateY(0);
}

.button {
  width: 64px;
  height: 64px;
  border-radius: 50%;
  border: none;
  background: #ffffff;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  color: #333;
  font-size: 24px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.button:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
}

.button.active {
  background: #f5222d;
  color: white;
  transform: scale(1.1);
  box-shadow: 0 8px 20px rgba(245, 34, 45, 0.3);
}
```

### 4.3 ChatPanel å¯¹è¯é¢æ¿

**åŸºäº Ant Design X ç»„ä»¶ï¼š**
- `Bubble` - å¯¹è¯æ°”æ³¡ï¼Œæ”¯æŒæµå¼è¾“å‡º
- `Conversations` - å¯¹è¯åˆ—è¡¨ç®¡ç†
- `Welcome` - æ¬¢è¿å¼•å¯¼ç»„ä»¶ï¼ˆå¯é€‰ï¼‰

**å‚è€ƒæ–‡æ¡£ï¼š** https://x.ant.design/

### 4.4 åç«¯ API Routes

#### `/api/chat` - Coze å¯¹è¯

```typescript
// app/api/chat/route.ts
import { CozeAPI, ChatEventType, RoleType } from '@coze/api'

export async function POST(request: Request) {
  const { message, conversationId } = await request.json()
  
  const client = new CozeAPI({
    token: process.env.COZE_API_KEY!,
  })

  // æµå¼å“åº”
  const stream = await client.chat.stream({
    bot_id: process.env.COZE_BOT_ID!,
    user_id: 'user_123',
    additional_messages: [
      { role: RoleType.User, content: message, content_type: 'text' }
    ],
  })

  // è¿”å› SSE æµ
  // ...
}
```

#### `/api/tts` - è¯­éŸ³åˆæˆ

```typescript
// app/api/tts/route.ts
import * as tencentcloud from 'tencentcloud-sdk-nodejs'

const TtsClient = tencentcloud.tts.v20190823.Client

export async function POST(request: Request) {
  const { text } = await request.json()
  
  const client = new TtsClient({
    credential: {
      secretId: process.env.TENCENT_SECRET_ID!,
      secretKey: process.env.TENCENT_SECRET_KEY!,
    },
    region: 'ap-guangzhou',
  })

  const result = await client.TextToVoice({
    Text: text,
    SessionId: Date.now().toString(),
    VoiceType: 101001, // éŸ³è‰² ID
    // ...å…¶ä»–å‚æ•°
  })

  return Response.json({ audio: result.Audio })
}
```

#### `/api/asr` - è¯­éŸ³è¯†åˆ«

```typescript
// app/api/asr/route.ts
// ä½¿ç”¨è…¾è®¯äº‘ä¸€å¥è¯è¯†åˆ«æˆ–å®æ—¶è¯­éŸ³è¯†åˆ«
// æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„ API
```

---

## äº”ã€ç¯å¢ƒå˜é‡é…ç½®

`.env.local` æ–‡ä»¶ï¼ˆä¸æäº¤ Gitï¼‰ï¼š

```env
# è…¾è®¯äº‘é…ç½®
TENCENT_SECRET_ID=your_secret_id
TENCENT_SECRET_KEY=your_secret_key
TENCENT_APP_ID=your_app_id

# Coze é…ç½®
COZE_API_KEY=your_coze_pat_token
COZE_BOT_ID=your_bot_id
```

---

## å…­ã€é¡µé¢å¸ƒå±€è®¾è®¡

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ™ºèƒ½ä½“åŒºåŸŸ (Avatar Section)    â”‚  å¯¹è¯äº¤äº’åŒºåŸŸ (Chat Section)  â”‚
â”‚                                 â”‚                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                               â”‚
â”‚ â”‚                             â”‚ â”‚                               â”‚
â”‚ â”‚      è§†é¢‘æ’­æ”¾å®¹å™¨           â”‚ â”‚                               â”‚
â”‚ â”‚      (Video Player)         â”‚ â”‚                               â”‚
â”‚ â”‚                             â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚   [ å½¢è±¡ N - çŠ¶æ€: Talk ]   â”‚ â”‚   â”‚ AI: å¥½çš„ï¼Œä¸ºä½ è·³èˆ... â”‚   â”‚
â”‚ â”‚                             â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”‚          ğŸ’ƒ                 â”‚ â”‚                               â”‚
â”‚ â”‚                             â”‚ â”‚                               â”‚
â”‚ â”‚                             â”‚ â”‚                               â”‚
â”‚ â”‚                             â”‚ â”‚                               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                               â”‚
â”‚                â”‚                â”‚                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                               â”‚
â”‚ â”‚      æ§åˆ¶æ  (Controls)      â”‚ â”‚                               â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚                               â”‚
â”‚ â”‚ â”‚ < å½¢è±¡ > â”‚  â”‚ ğŸ’ƒ è·³èˆ  â”‚  â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚ â”‚   â”‚     ğŸ¤ æŒ‰ä½è¯´è¯       â”‚   â”‚
â”‚ â”‚      â”‚             â”‚        â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”‚  åˆ‡æ¢å½¢è±¡      è§¦å‘åŠ¨ä½œ     â”‚ â”‚                               â”‚
â”‚ â”‚ (Dropdown)  (disabled if    â”‚ â”‚                               â”‚
â”‚ â”‚              talking)       â”‚ â”‚                               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                               â”‚
â”‚                                 â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸ƒã€å¼€å‘æ­¥éª¤

| é¡ºåº | ä»»åŠ¡ | è¯´æ˜ |
|------|------|------|
| 1 | é¡¹ç›®åˆå§‹åŒ– | åˆ›å»º Next.js é¡¹ç›®ï¼Œå®‰è£…ä¾èµ– |
| 2 | åŸºç¡€å¸ƒå±€ | æ­å»ºé¡µé¢å¸ƒå±€æ¡†æ¶ |
| 3 | AvatarVideo | å®ç°è§†é¢‘æ’­æ”¾ç»„ä»¶ |
| 4 | ChatPanel | åŸºäº Ant Design X æ­å»ºå¯¹è¯ UI |
| 5 | chatStore | ä½¿ç”¨ Zustand ç®¡ç†å¯¹è¯çŠ¶æ€ |
| 6 | /api/chat | å®ç° Coze å¯¹è¯ä»£ç†æ¥å£ |
| 7 | /api/tts | å®ç°è…¾è®¯äº‘è¯­éŸ³åˆæˆæ¥å£ |
| 8 | /api/asr | å®ç°è…¾è®¯äº‘è¯­éŸ³è¯†åˆ«æ¥å£ |
| 9 | VoiceButton | å®ç°è¯­éŸ³è¾“å…¥ç»„ä»¶ |
| 10 | è”è°ƒæµ‹è¯• | ä¸²è”å®Œæ•´è¯­éŸ³äº¤äº’æµç¨‹ |

---

## å…«ã€é¡¹ç›®åˆ›å»ºå‘½ä»¤

### 8.1 åˆ›å»º Next.js é¡¹ç›®

```bash
npx create-next-app@latest x-mozi
```

åˆ›å»ºæ—¶é€‰æ‹©ï¼š
- âœ… TypeScript
- âœ… ESLint
- âœ… Tailwind CSSï¼ˆå¯é€‰ï¼‰
- âœ… App Router
- âŒ src/ directoryï¼ˆå¯é€‰ï¼‰
- âŒ Turbopackï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼Œå¯é€‰ï¼‰

### 8.2 å®‰è£…é¡¹ç›®ä¾èµ–

```bash
cd x-mozi

# UI æ¡†æ¶
npm install antd@^6.0.1 @ant-design/x@^2.1.0

# çŠ¶æ€ç®¡ç†
npm install zustand@^5.0.9

# åç«¯ SDK
npm install tencentcloud-sdk-nodejs @coze/api axios

# éŸ³é¢‘å¯è§†åŒ–ä¸åŠ¨ç”»
npm install react-audio-visualize react-media-recorder framer-motion clsx
```

### 8.3 åˆ›å»ºç›®å½•ç»“æ„

```bash
mkdir -p components/AvatarVideo
mkdir -p components/VoiceButton
mkdir -p components/ChatPanel
mkdir -p services
mkdir -p hooks
mkdir -p store
mkdir -p public/videos
mkdir -p app/api/chat
mkdir -p app/api/tts
mkdir -p app/api/asr
```

---

## ä¹ã€å‚è€ƒèµ„æ–™

- [Ant Design X å®˜æ–¹æ–‡æ¡£](https://x.ant.design/)
- [Ant Design 6.0 ç»„ä»¶](https://ant.design/components/overview-cn/)
- [Next.js æ–‡æ¡£](https://nextjs.org/docs)
- [React 19 æ–‡æ¡£](https://react.dev/)
- [Zustand 5.0 æ–‡æ¡£](https://zustand.docs.pmnd.rs/getting-started/introduction)
- [è…¾è®¯äº‘è¯­éŸ³åˆæˆæ–‡æ¡£](https://cloud.tencent.com/document/product/1073/37985)
- [Coze API æ–‡æ¡£](https://www.coze.com/docs)

---

## åã€æ³¨æ„äº‹é¡¹

1. **æµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾é™åˆ¶**ï¼šé¦–æ¬¡åŠ è½½éœ€ç”¨æˆ·äº¤äº’åæ‰èƒ½æ’­æ”¾å¸¦å£°éŸ³çš„è§†é¢‘/éŸ³é¢‘

2. **éº¦å…‹é£æƒé™**ï¼šéœ€è¦ HTTPS ç¯å¢ƒæˆ– localhost æ‰èƒ½è·å–éº¦å…‹é£æƒé™

3. **API å¯†é’¥å®‰å…¨**ï¼š
   - ä½¿ç”¨ `.env.local` å­˜å‚¨å¯†é’¥
   - ç¡®ä¿ `.env.local` åœ¨ `.gitignore` ä¸­
   - æ‰€æœ‰æ•æ„Ÿ API è°ƒç”¨éƒ½é€šè¿‡ API Routes è¿›è¡Œ

4. **è…¾è®¯äº‘è¯­éŸ³æœåŠ¡**ï¼š
   - æ²¡æœ‰å®˜æ–¹æµè§ˆå™¨ç«¯ JS SDK
   - å¿…é¡»é€šè¿‡åç«¯ä»£ç†è°ƒç”¨
   - æ”¯æŒçš„ SDKï¼šGoã€Pythonã€Node.js

5. **Coze SDK**ï¼š
   - å®˜æ–¹ SDKï¼š`@coze/api`
   - æ”¯æŒæµå¼å“åº”

